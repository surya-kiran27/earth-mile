{"version":3,"sources":["Context/actions.js","Context/reducer.js","Context/context.js","config/routes.js","components/Login.js","components/EarthMileMap.js","components/Home.js","components/AppRoute.js","index.js"],"names":["ROOT_URL","loginUser","dispatch","a","requestOptions","method","headers","credentials","type","fetch","response","json","data","user","payload","localStorage","setItem","JSON","stringify","error","initialState","getItem","parse","loading","errorMessage","AuthReducer","action","Error","AuthStateContext","React","createContext","AuthDispatchContext","useAuthState","context","useContext","undefined","AuthProvider","children","useReducer","Provider","value","routes","path","component","Container","style","marginTop","Button","variant","color","onClick","window","location","href","isPrivate","props","useState","position","setPosition","earthMiles","setEarthMiles","setErr","fillRed","fillColor","useEffect","navigator","geolocation","getCurrentPosition","coords","console","log","alert","timeout","enableHighAccuracy","latitude","longitude","axios","get","success","earth_miles","getearthMiles","MapContainer","center","lat","lng","zoom","scrollWheelZoom","width","height","TileLayer","attribution","url","LayerGroup","map","earthMile","Circle","pathOptions","radius","Tooltip","Typography","display","gutterBottom","users","length","posts","fromNow","date","createdAt","Marker","draggable","useAuthDispatch","history","push","login","earth_mile_id","AppRoutes","Component","rest","state","render","Boolean","to","pathname","ReactDOM","StrictMode","route","AppRoute","document","getElementById"],"mappings":"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","file":"static/js/main.bf41515b.chunk.js","sourcesContent":["const ROOT_URL = \"http://localhost:8000\";\r\n\r\nexport async function loginUser(dispatch) {\r\n  const requestOptions = {\r\n    method: \"GET\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    credentials: \"include\",\r\n  };\r\n\r\n  try {\r\n    dispatch({ type: \"REQUEST_LOGIN\" });\r\n    let response = await fetch(\r\n      `${ROOT_URL}/users/google/check`,\r\n      requestOptions\r\n    );\r\n    let data = await response.json();\r\n    if (data.user) {\r\n      dispatch({ type: \"LOGIN_SUCCESS\", payload: data.user });\r\n      localStorage.setItem(\"currentUser\", JSON.stringify(data.user));\r\n      return data;\r\n    } else {\r\n      dispatch({ type: \"LOGIN_ERROR\", error: \"Error Ocurred Try again!\" });\r\n    }\r\n\r\n    return;\r\n  } catch (error) {\r\n    dispatch({ type: \"LOGIN_ERROR\", error: \"Error Ocurred Try again!\" });\r\n  }\r\n}\r\n\r\nexport async function logout(dispatch) {\r\n  dispatch({ type: \"LOGOUT\" });\r\n  localStorage.removeItem(\"currentUser\");\r\n}\r\n","// Context/reducer.js\r\n\r\nlet user = localStorage.getItem(\"currentUser\")\r\n  ? JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  : \"\";\r\n\r\nexport const initialState = {\r\n  user: \"\" || user,\r\n  loading: false,\r\n  errorMessage: null,\r\n};\r\n\r\nexport const AuthReducer = (initialState, action) => {\r\n  switch (action.type) {\r\n    case \"REQUEST_LOGIN\":\r\n      return {\r\n        ...initialState,\r\n        loading: true,\r\n      };\r\n    case \"LOGIN_SUCCESS\":\r\n      return {\r\n        ...initialState,\r\n        user: action.payload,\r\n        loading: false,\r\n      };\r\n    case \"LOGOUT\":\r\n      return {\r\n        ...initialState,\r\n        user: \"\",\r\n      };\r\n\r\n    case \"LOGIN_ERROR\":\r\n      return {\r\n        ...initialState,\r\n        loading: false,\r\n        errorMessage: action.error,\r\n      };\r\n\r\n    default:\r\n      throw new Error(`Unhandled action type: ${action.type}`);\r\n  }\r\n};\r\n","import React, { useReducer } from \"react\";\r\nimport { AuthReducer, initialState } from \"./reducer\";\r\nexport const AuthStateContext = React.createContext();\r\nexport const AuthDispatchContext = React.createContext();\r\n\r\nexport function useAuthState() {\r\n  const context = React.useContext(AuthStateContext);\r\n  if (context === undefined) {\r\n    throw new Error(\"useAuthState must be used within a AuthProvider\");\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\nexport function useAuthDispatch() {\r\n  const context = React.useContext(AuthDispatchContext);\r\n  if (context === undefined) {\r\n    throw new Error(\"useAuthDispatch must be used within a AuthProvider\");\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, dispatch] = useReducer(AuthReducer, initialState);\r\n\r\n  return (\r\n    <AuthStateContext.Provider value={user}>\r\n      <AuthDispatchContext.Provider value={dispatch}>\r\n        {children}\r\n      </AuthDispatchContext.Provider>\r\n    </AuthStateContext.Provider>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport Login from \"../components/Login\";\r\nimport Home from \"../components/Home\";\r\nimport EarthMileMap from \"../components/EarthMileMap\";\r\nconst routes = [\r\n  {\r\n    path: \"/login\",\r\n    component: Login,\r\n    isPrivate: false,\r\n  },\r\n  {\r\n    path: \"/earthMileMap\",\r\n    component: EarthMileMap,\r\n    isPrivate: false,\r\n  },\r\n  {\r\n    path: \"/\",\r\n    component: Home,\r\n    isPrivate: false,\r\n  },\r\n\r\n  //   {\r\n  //     path: \"/*\",\r\n  //     component: NotFound,\r\n  //     isPrivate: true,\r\n  //   },\r\n];\r\n\r\nexport default routes;\r\n","import React from \"react\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Container from \"@material-ui/core/Container\";\r\n\r\nexport default function Login() {\r\n  return (\r\n    <div>\r\n      <Container style={{ marginTop: \"20%\" }}>\r\n        <center>\r\n          <h1>Login</h1>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={() => {\r\n              window.location.href = \"http://localhost:8000/users/login/google\";\r\n            }}\r\n          >\r\n            Google Login\r\n          </Button>\r\n        </center>\r\n      </Container>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useAuthState } from \"../Context\";\r\nimport axios from \"axios\";\r\nimport {\r\n  MapContainer,\r\n  TileLayer,\r\n  Circle,\r\n  LayerGroup,\r\n  Tooltip,\r\n  Marker,\r\n} from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Moment from \"react-moment\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nexport default function EarthMileMap(props) {\r\n  const { user } = useAuthState(); //read the values of loading and errorMessage from context\r\n  const [position, setPosition] = useState(null);\r\n  const [earthMiles, setEarthMiles] = useState([]);\r\n  const [err, setErr] = useState(\"\");\r\n  const fillRed = { fillColor: \"red\" };\r\n  useEffect(() => {\r\n    navigator.geolocation.getCurrentPosition(\r\n      async function (position) {\r\n        setPosition(position.coords);\r\n      },\r\n      function errorCallback(error) {\r\n        console.log(error);\r\n        alert(\"could not get your location\");\r\n      },\r\n      {\r\n        timeout: 5000,\r\n        enableHighAccuracy: true,\r\n      }\r\n    );\r\n  }, []);\r\n  useEffect(() => {\r\n    if (position != null) {\r\n      async function getearthMiles() {\r\n        const { latitude, longitude } = position;\r\n        let response = await axios.get(\r\n          `http://localhost:8000/earth-miles?coordinates=${longitude},${latitude}`\r\n        );\r\n        console.log(response);\r\n        if (response.data.success) {\r\n          setEarthMiles(response.data.earth_miles);\r\n        } else {\r\n          setErr(\"Error fetching earth miles\");\r\n        }\r\n      }\r\n      getearthMiles();\r\n    }\r\n  }, [position]);\r\n  return (\r\n    <Container>\r\n      <center>\r\n        <h1>Earth Miles Around you</h1>\r\n      </center>\r\n      {console.log(user)}\r\n      {position != null ? (\r\n        <MapContainer\r\n          center={{ lat: position.latitude, lng: position.longitude }}\r\n          zoom={11}\r\n          scrollWheelZoom={true}\r\n          style={{ width: \"100%\", height: \"80vh\" }}\r\n        >\r\n          <TileLayer\r\n            attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          />\r\n\r\n          <LayerGroup>\r\n            {earthMiles.map((earthMile) => {\r\n              return (\r\n                <Circle\r\n                  center={[earthMile.location[1], earthMile.location[0]]}\r\n                  pathOptions={fillRed}\r\n                  radius={1609}\r\n                >\r\n                  <Tooltip>\r\n                    <Container>\r\n                      <center>\r\n                        <Typography\r\n                          variant=\"overline\"\r\n                          display=\"block\"\r\n                          gutterBottom\r\n                        >\r\n                          Users: <b>{earthMile.users.length}</b>\r\n                        </Typography>\r\n                        <br />\r\n                        <Typography\r\n                          variant=\"overline\"\r\n                          display=\"block\"\r\n                          gutterBottom\r\n                        >\r\n                          Posts: <b>{earthMile.posts.length}</b>\r\n                        </Typography>\r\n                        <br />\r\n                        <Typography\r\n                          variant=\"overline\"\r\n                          display=\"block\"\r\n                          gutterBottom\r\n                        >\r\n                          Created\r\n                          <b>\r\n                            {\" \"}\r\n                            <Moment fromNow date={earthMile.createdAt}></Moment>\r\n                          </b>\r\n                        </Typography>\r\n                        <Button\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          onClick={() => {\r\n                            window.location.href =\r\n                              \"http://localhost:8000/users/login/google\";\r\n                          }}\r\n                        >\r\n                          View\r\n                        </Button>\r\n                      </center>\r\n                    </Container>\r\n                  </Tooltip>\r\n                </Circle>\r\n              );\r\n            })}\r\n            <Marker\r\n              position={{ lat: position.latitude, lng: position.longitude }}\r\n              draggable={false}\r\n            ></Marker>\r\n          </LayerGroup>\r\n        </MapContainer>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </Container>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\nimport { loginUser, useAuthDispatch, useAuthState } from \"../Context\";\n\nexport default function Home(props) {\n  const { user } = useAuthState(); //read the values of loading and errorMessage from context\n  const dispatch = useAuthDispatch(); //get the dispatch method from the useDispatch custom hook\n\n  useEffect(() => {\n    console.log(user);\n    if (user === \"\") {\n      async function login() {\n        let response = await loginUser(dispatch);\n        if (!response.user) props.history.push(\"/login\");\n      }\n      login();\n    }\n  }, [user, dispatch, props]);\n\n  useEffect(() => {\n    if (user.earth_mile_id !== \"\") {\n    } else {\n    }\n  });\n  return <div>Hellow World</div>;\n}\n","import React from \"react\";\r\nimport { Redirect, Route } from \"react-router-dom\";\r\n\r\nimport { useAuthState } from \"../Context\";\r\n\r\nconst AppRoutes = ({ component: Component, path, isPrivate, ...rest }) => {\r\n  const state = useAuthState();\r\n  console.log(state);\r\n  return (\r\n    <Route\r\n      path={path}\r\n      render={(props) =>\r\n        isPrivate && Boolean(state.user === \"\") ? (\r\n          <Redirect to={{ pathname: \"/login\" }} />\r\n        ) : (\r\n          <Component {...props} />\r\n        )\r\n      }\r\n      {...rest}\r\n    />\r\n  );\r\n};\r\n\r\nexport default AppRoutes;\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport routes from \"./config/routes\";\nimport AppRoute from \"./components/AppRoute\";\nimport { BrowserRouter as Router, Switch } from \"react-router-dom\";\nimport { AuthProvider } from \"./Context/context\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <AuthProvider>\n      <Router>\n        <Switch>\n          {routes.map((route) => (\n            <AppRoute\n              key={route.path}\n              path={route.path}\n              component={route.component}\n              isPrivate={route.isPrivate}\n            />\n          ))}\n        </Switch>\n      </Router>\n    </AuthProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}