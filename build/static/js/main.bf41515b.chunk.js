(this["webpackJsonpearthmile-frontend"]=this["webpackJsonpearthmile-frontend"]||[]).push([[0],{84:function(e,t,r){"use strict";r.r(t);var n=r(2),c=r(0),a=r.n(c),o=r(24),s=r.n(o),i=r(105),u=r(99);var l=r(11),h=r.n(l),j=r(25),d="http://localhost:8000";function p(e){return b.apply(this,arguments)}function b(){return(b=Object(j.a)(h.a.mark((function e(t){var r,n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"},e.prev=1,t({type:"REQUEST_LOGIN"}),e.next=5,fetch("".concat(d,"/users/google/check"),r);case 5:return n=e.sent,e.next=8,n.json();case 8:if(!(c=e.sent).user){e.next=15;break}return t({type:"LOGIN_SUCCESS",payload:c.user}),localStorage.setItem("currentUser",JSON.stringify(c.user)),e.abrupt("return",c);case 15:t({type:"LOGIN_ERROR",error:"Error Ocurred Try again!"});case 16:return e.abrupt("return");case 19:e.prev=19,e.t0=e.catch(1),t({type:"LOGIN_ERROR",error:"Error Ocurred Try again!"});case 22:case"end":return e.stop()}}),e,null,[[1,19]])})))).apply(this,arguments)}var O=r(22),f=r(4),g={user:localStorage.getItem("currentUser")?JSON.parse(localStorage.getItem("currentUser")):"",loading:!1,errorMessage:null},x=function(e,t){switch(t.type){case"REQUEST_LOGIN":return Object(f.a)(Object(f.a)({},e),{},{loading:!0});case"LOGIN_SUCCESS":return Object(f.a)(Object(f.a)({},e),{},{user:t.payload,loading:!1});case"LOGOUT":return Object(f.a)(Object(f.a)({},e),{},{user:""});case"LOGIN_ERROR":return Object(f.a)(Object(f.a)({},e),{},{loading:!1,errorMessage:t.error});default:throw new Error("Unhandled action type: ".concat(t.type))}},v=a.a.createContext(),m=a.a.createContext();function y(){var e=a.a.useContext(v);if(void 0===e)throw new Error("useAuthState must be used within a AuthProvider");return e}var w=function(e){var t=e.children,r=Object(c.useReducer)(x,g),a=Object(O.a)(r,2),o=a[0],s=a[1];return Object(n.jsx)(v.Provider,{value:o,children:Object(n.jsx)(m.Provider,{value:s,children:t})})};var E=r(47),S=r.n(E),C=r(100),k=r(106),P=r(101),R=r(107),I=r(102),G=r(104),L=(r(79),r(103)),N=r(48),U=r.n(N);var _=[{path:"/login",component:function(){return Object(n.jsx)("div",{children:Object(n.jsx)(u.a,{style:{marginTop:"20%"},children:Object(n.jsxs)("center",{children:[Object(n.jsx)("h1",{children:"Login"}),Object(n.jsx)(i.a,{variant:"contained",color:"primary",onClick:function(){window.location.href="http://localhost:8000/users/login/google"},children:"Google Login"})]})})})},isPrivate:!1},{path:"/earthMileMap",component:function(e){var t=y().user,r=Object(c.useState)(null),a=Object(O.a)(r,2),o=a[0],s=a[1],l=Object(c.useState)([]),d=Object(O.a)(l,2),p=d[0],b=d[1],f=Object(c.useState)(""),g=Object(O.a)(f,2),x=(g[0],g[1]),v={fillColor:"red"};return Object(c.useEffect)((function(){navigator.geolocation.getCurrentPosition(function(){var e=Object(j.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(t.coords);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.log(e),alert("could not get your location")}),{timeout:5e3,enableHighAccuracy:!0})}),[]),Object(c.useEffect)((function(){null!=o&&function(){var e=Object(j.a)(h.a.mark((function e(){var t,r,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.latitude,r=o.longitude,e.next=3,S.a.get("http://localhost:8000/earth-miles?coordinates=".concat(r,",").concat(t));case 3:n=e.sent,console.log(n),n.data.success?b(n.data.earth_miles):x("Error fetching earth miles");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[o]),Object(n.jsxs)(u.a,{children:[Object(n.jsx)("center",{children:Object(n.jsx)("h1",{children:"Earth Miles Around you"})}),console.log(t),null!=o?Object(n.jsxs)(C.a,{center:{lat:o.latitude,lng:o.longitude},zoom:11,scrollWheelZoom:!0,style:{width:"100%",height:"80vh"},children:[Object(n.jsx)(k.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(n.jsxs)(P.a,{children:[p.map((function(e){return Object(n.jsx)(R.a,{center:[e.location[1],e.location[0]],pathOptions:v,radius:1609,children:Object(n.jsx)(I.a,{children:Object(n.jsx)(u.a,{children:Object(n.jsxs)("center",{children:[Object(n.jsxs)(L.a,{variant:"overline",display:"block",gutterBottom:!0,children:["Users: ",Object(n.jsx)("b",{children:e.users.length})]}),Object(n.jsx)("br",{}),Object(n.jsxs)(L.a,{variant:"overline",display:"block",gutterBottom:!0,children:["Posts: ",Object(n.jsx)("b",{children:e.posts.length})]}),Object(n.jsx)("br",{}),Object(n.jsxs)(L.a,{variant:"overline",display:"block",gutterBottom:!0,children:["Created",Object(n.jsxs)("b",{children:[" ",Object(n.jsx)(U.a,{fromNow:!0,date:e.createdAt})]})]}),Object(n.jsx)(i.a,{variant:"contained",color:"primary",onClick:function(){window.location.href="http://localhost:8000/users/login/google"},children:"View"})]})})})})})),Object(n.jsx)(G.a,{position:{lat:o.latitude,lng:o.longitude},draggable:!1})]})]}):""]})},isPrivate:!1},{path:"/",component:function(e){var t=y().user,r=function(){var e=a.a.useContext(m);if(void 0===e)throw new Error("useAuthDispatch must be used within a AuthProvider");return e}();return Object(c.useEffect)((function(){(console.log(t),""===t)&&function(){var t=Object(j.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p(r);case 2:t.sent.user||e.history.push("/login");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[t,r,e]),Object(c.useEffect)((function(){t.earth_mile_id})),Object(n.jsx)("div",{children:"Hellow World"})},isPrivate:!1}],T=r(14),A=r(5),M=function(e){var t=e.component,r=e.path,c=e.isPrivate,a=Object(T.a)(e,["component","path","isPrivate"]),o=y();return console.log(o),Object(n.jsx)(A.b,Object(f.a)({path:r,render:function(e){return c&&Boolean(""===o.user)?Object(n.jsx)(A.a,{to:{pathname:"/login"}}):Object(n.jsx)(t,Object(f.a)({},e))}},a))},B=r(34);s.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(w,{children:Object(n.jsx)(B.a,{children:Object(n.jsx)(A.d,{children:_.map((function(e){return Object(n.jsx)(M,{path:e.path,component:e.component,isPrivate:e.isPrivate},e.path)}))})})})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.bf41515b.chunk.js.map