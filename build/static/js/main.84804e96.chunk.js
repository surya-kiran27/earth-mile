(this["webpackJsonpearthmile-frontend"]=this["webpackJsonpearthmile-frontend"]||[]).push([[0],{154:function(e,t,a){},159:function(e,t,a){},160:function(e,t,a){},161:function(e,t,a){"use strict";a.r(t);var r=a(2),n=a(0),c=a.n(n),s=a(12),i=a.n(s),o=a(205),l=a(202);var u=a(14),j=a.n(u),d=a(19),h=a(9),b=a(33),O=a.n(b),p="http://localhost:8000";function m(e){return x.apply(this,arguments)}function x(){return(x=Object(d.a)(j.a.mark((function e(t){var a,r,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"},e.prev=1,t({type:"REQUEST_LOGIN"}),e.next=5,fetch("".concat(p,"/users/google/check"),a);case 5:return r=e.sent,e.next=8,r.json();case 8:if(!(n=e.sent).user){e.next=15;break}return t({type:"LOGIN_SUCCESS",payload:n.user}),localStorage.setItem("currentUser",JSON.stringify(n.user)),e.abrupt("return",n);case 15:t({type:"LOGIN_ERROR",error:"Error Ocurred Try again!"});case 16:return e.abrupt("return");case 19:e.prev=19,e.t0=e.catch(1),t({type:"LOGIN_ERROR",error:"Error Ocurred Try again!"});case 22:case"end":return e.stop()}}),e,null,[[1,19]])})))).apply(this,arguments)}function f(){return(f=Object(d.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"LOGOUT"}),localStorage.removeItem("currentUser"),e.next=4,fetch("".concat(p,"/users/logout"));case 4:e.sent;case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=a(13),g={user:localStorage.getItem("currentUser")?JSON.parse(localStorage.getItem("currentUser")):"",loading:!1,errorMessage:null},y=function(e,t){switch(t.type){case"REQUEST_LOGIN":return Object(v.a)(Object(v.a)({},e),{},{loading:!0});case"LOGIN_SUCCESS":return Object(v.a)(Object(v.a)({},e),{},{user:t.payload,loading:!1});case"LOGOUT":return Object(v.a)(Object(v.a)({},e),{},{user:""});case"LOGIN_ERROR":return Object(v.a)(Object(v.a)({},e),{},{loading:!1,errorMessage:t.error});default:throw new Error("Unhandled action type: ".concat(t.type))}},w=c.a.createContext(),C=c.a.createContext();function E(){var e=c.a.useContext(w);if(void 0===e)throw new Error("useAuthState must be used within a AuthProvider");return e}function S(){var e=c.a.useContext(C);if(void 0===e)throw new Error("useAuthDispatch must be used within a AuthProvider");return e}var N=function(e){var t=e.children,a=Object(n.useReducer)(y,g),c=Object(h.a)(a,2),s=c[0],i=c[1];return Object(r.jsx)(w.Provider,{value:s,children:Object(r.jsx)(C.Provider,{value:i,children:t})})},k=a(211),_=a(226),P=a(213),M=a(21),A=a(58),R=a(224);function I(e){var t=e.children,a=e.value,n=e.index,c=Object(M.a)(e,["children","value","index"]);return Object(r.jsx)("div",Object(v.a)(Object(v.a)({role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},c),{},{children:a===n&&Object(r.jsx)(R.a,{p:3,children:Object(r.jsx)(A.a,{children:t})})}))}var T=a(93),U=a.n(T),L=a(212),G=a(15),H=a(207),W=a(208),B=a(230),z=a(209),J=a(210),D=a(206),V=a(65),Q=a.n(V),Y=Object(D.a)({cardHeaderRoot:{overflow:"hidden"},cardHeaderContent:{overflow:"hidden"}});function F(e){var t=Y();return Object(r.jsx)("div",{children:Object(r.jsxs)(H.a,{className:"card",children:[Object(r.jsx)(W.a,{avatar:Object(r.jsx)(B.a,{className:"avatar",alt:e.username,src:e.image}),className:{root:t.cardHeaderRoot,content:t.cardHeaderContent},title:e.username,subheader:Object(r.jsx)(Q.a,{fromNow:!0,date:e.createdAt})}),Object(r.jsxs)(z.a,{className:{root:t.cardHeaderRoot,content:t.cardHeaderContent},children:[Object(r.jsx)(A.a,{variant:"h6",gutterBottom:!0,children:e.title}),Object(r.jsx)(A.a,{noWrap:!0,variant:"body2",color:"textSecondary",children:e.description})]}),Object(r.jsx)(J.a,{children:Object(r.jsx)(o.a,{size:"small",children:"View"})})]})})}a(154);var Z=a(214),q=a(231),K=a(215),X=a(232),$=a(216),ee=a(217),te=a(233),ae=(a(158),a(20)),re=a.n(ae),ne=a(228),ce=a(222),se=a(219),ie=a(218),oe=a(94),le=a(95),ue=a(229),je=re.a.icon({iconUrl:oe.a,iconSize:[28,40],iconAnchor:[14,20],shadowUrl:le.a});var de=a(220),he=a(163),be=a(235),Oe=a(225),pe=a(236);var me=[{path:"/login",component:function(){return Object(r.jsx)("div",{children:Object(r.jsx)(l.a,{style:{marginTop:"20%"},children:Object(r.jsxs)("center",{children:[Object(r.jsx)("h1",{children:"Login"}),Object(r.jsx)(o.a,{variant:"contained",color:"primary",onClick:function(){window.location.href="http://localhost:8000/users/login/google"},children:"Google Login"})]})})})},isPrivate:!1},{path:"/earthMileMap",component:function(e){var t=Object(n.useState)(""),a=Object(h.a)(t,2),s=a[0],i=a[1],u=Object(n.useState)(null),b=Object(h.a)(u,2),p=b[0],m=b[1],x=Object(n.useState)({lat:"",lng:""}),f=Object(h.a)(x,2),v=f[0],g=f[1],y=Object(n.useState)(!1),w=Object(h.a)(y,2),C=(w[0],w[1]),E=Object(n.useState)([]),S=Object(h.a)(E,2),N=S[0],k=S[1],_=c.a.useState(!1),P=Object(h.a)(_,2),M=P[0],R=P[1],I=Object(n.useState)(""),T=Object(h.a)(I,2),U=T[0],L=T[1],H=Object(n.useState)(""),W=Object(h.a)(H,2),B=W[0],z=W[1],J=Object(n.useState)({redirect:!1,state:null}),D=Object(h.a)(J,2),V=(D[0],D[1],Object(n.useState)("")),Y=Object(h.a)(V,2),F=(Y[0],Y[1]),ae={fillColor:"red"},re={fillColor:"blue"},oe={fillColor:"green"},le=Object(n.useRef)(null),de=Object(G.g)();return Object(n.useEffect)((function(){navigator.geolocation.getCurrentPosition(function(){var e=Object(d.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m(t.coords),g({lat:t.coords.latitude,lng:t.coords.longitude});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.log(e),alert("could not get your location")}),{timeout:5e3,enableHighAccuracy:!0})}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("http://localhost:8000/users/getEarthMile");case 2:t=e.sent,console.log(t),t.data.success?i(t.data.earth_mile_id):F("Error fetching earth miles");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[s]),Object(n.useEffect)((function(){null!=p&&function(){var e=Object(d.a)(j.a.mark((function e(){var t,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.latitude,a=p.longitude,e.next=3,O.a.get("http://localhost:8000/earth-miles?coordinates=".concat(a,",").concat(t));case 3:r=e.sent,console.log(r),r.data.success?k(r.data.earth_miles):F("Error fetching earth miles");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[p]),Object(r.jsxs)(l.a,{children:[Object(r.jsx)("center",{children:Object(r.jsx)("h1",{children:"Earth Miles Around you"})}),null!=p?Object(r.jsxs)("div",{children:[Object(r.jsxs)(Z.a,{center:{lat:p.latitude,lng:p.longitude},zoom:13,scrollWheelZoom:!0,style:{width:"100%",height:"80vh"},children:[Object(r.jsx)(q.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(r.jsxs)(K.a,{children:[N.map((function(e){return Object(r.jsx)(X.a,{center:[e.location[1],e.location[0]],pathOptions:re,radius:1609,children:Object(r.jsx)($.a,{children:Object(r.jsx)(l.a,{children:Object(r.jsxs)("center",{children:[Object(r.jsxs)(A.a,{variant:"overline",display:"block",gutterBottom:!0,children:["Users: ",Object(r.jsx)("b",{children:e.users.length})]}),Object(r.jsx)("br",{}),Object(r.jsxs)(A.a,{variant:"overline",display:"block",gutterBottom:!0,children:["Posts: ",Object(r.jsx)("b",{children:e.No_Posts})]}),Object(r.jsx)("br",{}),Object(r.jsxs)(A.a,{variant:"overline",display:"block",gutterBottom:!0,children:["Created",Object(r.jsxs)("b",{children:[" ",Object(r.jsx)(Q.a,{fromNow:!0,date:e.createdAt})]})]}),Object(r.jsx)(o.a,{variant:"contained",color:"primary",onClick:function(){console.log("cliecked",e._id),de.push({pathname:"/",state:{earth_mile_id:e._id}})},children:"View"})]})})})})})),Object(r.jsx)(ee.a,{position:{lat:p.latitude,lng:p.longitude},draggable:!1,title:"Your location",icon:je}),""===s?Object(r.jsx)(te.a,{children:function(e){return e.on("mouseup",(function(t){e.dragging.enable(),e.removeEventListener("mousemove")})),Object(r.jsxs)("div",{children:[Object(r.jsx)(X.a,{center:{lat:p.latitude,lng:p.longitude},pathOptions:oe,radius:1609}),Object(r.jsx)(X.a,{center:[v.lat,v.lng],pathOptions:ae,radius:1300,ref:le,eventHandlers:{mousedown:function(){e.dragging.disable(),e.on("mousemove",(function(e){g({lat:e.latlng.lat,lng:e.latlng.lng})}))}}})]})}}):""]}),""===s?Object(r.jsx)(o.a,{style:{float:"right",zIndex:"999",margin:"5px",position:"relative"},variant:"contained",color:"primary",onClick:function(){C(!0),R(!0)},disabled:!!M,children:"Click to create earth mile"}):""]}),Object(r.jsxs)(ne.a,{open:M,onClose:function(){return R(!1)},"aria-labelledby":"form-dialog-title",children:[Object(r.jsx)(ie.a,{id:"form-dialog-title",children:"Earth Mile Details"}),Object(r.jsxs)(se.a,{children:[Object(r.jsx)(ue.a,{autoFocus:!0,margin:"dense",id:"name",label:"Enter Project Name",type:"text",value:U,onChange:function(e){L(e.target.value)},fullWidth:!0}),Object(r.jsx)(ue.a,{margin:"dense",id:"address",label:"Enter Address",type:"text",value:B,onChange:function(e){z(e.target.value)},fullWidth:!0})]}),Object(r.jsxs)(ce.a,{children:[Object(r.jsx)(o.a,{onClick:function(){R(!1)},color:"primary",children:"Cancel"}),Object(r.jsx)(o.a,{onClick:Object(d.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==U){e.next=3;break}return alert("Project Name cannot be empty"),e.abrupt("return");case 3:if(""!==B){e.next=6;break}return alert("Earth mile address cannot be empty"),e.abrupt("return");case 6:return t={coordinates:"".concat(v.lng,",").concat(v.lat),address:B,name:U},e.prev=7,e.next=10,O.a.post("http://localhost:8000/earth-miles/create",t);case 10:a=e.sent,console.log(a),a.data.success?alert("Earth Mile created successfully"):alert("Earth Mile creation failed ".concat(a.data.message)),C(!1),R(!1),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),alert("Error Occured!");case 20:case"end":return e.stop()}}),e,null,[[7,17]])}))),color:"primary",children:"Confirm"})]})]})]}):""]})},isPrivate:!0},{path:"/createPost",component:function(e){var t=Object(G.h)(),a=Object(n.useState)(""),s=Object(h.a)(a,2),i=s[0],l=s[1],u=Object(n.useState)(""),b=Object(h.a)(u,2),p=b[0],m=b[1],x=Object(n.useState)(""),f=Object(h.a)(x,2),v=f[0],g=f[1],y=c.a.useState(""),w=Object(h.a)(y,2),C=w[0],E=w[1];return Object(r.jsxs)("div",{className:"wrapper",children:[Object(r.jsx)("div",{className:"row",children:Object(r.jsx)("center",{children:Object(r.jsx)(A.a,{display:"block",variant:"h3",gutterBottom:!0,children:"Create Post"})})}),Object(r.jsx)("div",{className:"row",children:Object(r.jsx)(de.a,{placeholder:"Enter Title",fullWidth:!0,value:i,onChange:function(e){l(e.target.value)}})}),Object(r.jsx)("div",{className:"row",children:Object(r.jsx)(de.a,{fullWidth:!0,value:p,placeholder:"Enter Description",onChange:function(e){m(e.target.value)}})}),Object(r.jsx)("div",{className:"row",children:Object(r.jsx)(he.a,{className:"textarea",value:v,rowsMax:5,rowsMin:5,placeholder:"Enter Body",onChange:function(e){g(e.target.value)}})}),Object(r.jsxs)("div",{className:"row",children:[Object(r.jsx)(be.a,{id:"demo-simple-select-label",children:"Category"}),Object(r.jsxs)(Oe.a,{fullWidth:!0,labelId:"demo-simple-select-label",id:"demo-simple-select",value:C,onChange:function(e){E(e.target.value)},children:[Object(r.jsx)(pe.a,{value:"humans",children:"Humans"}),Object(r.jsx)(pe.a,{value:"animals",children:"Animals"}),Object(r.jsx)(pe.a,{value:"environment",children:"Environment"})]})]}),Object(r.jsx)("div",{className:"row",children:Object(r.jsx)(o.a,{fullWidth:!0,variant:"outlined",color:"secondary",onClick:Object(d.a)(j.a.mark((function e(){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={title:i,body:v,description:p,category:C,earth_mile_id:t.state.earth_mile_id},e.next=3,O.a.post("http://localhost:8000/earth-miles/create-post",a);case 3:r=e.sent,console.log(r),r.data.success&&alert("Post created");case 6:case"end":return e.stop()}}),e)}))),children:"Sumbit"})})]})},isPrivate:!0},{path:"/",component:function(e){var t=Object(G.h)(),a=S(),s=Object(G.g)(),i=c.a.useState(0),u=Object(h.a)(i,2),b=u[0],p=u[1],x=Object(n.useState)(t.state&&void 0!==t.state.earth_mile_id?t.state.earth_mile_id:""),f=Object(h.a)(x,2),v=f[0],g=f[1],y=Object(n.useState)(null),w=Object(h.a)(y,2),C=w[0],E=w[1],N=Object(n.useState)([]),M=Object(h.a)(N,2),R=M[0],T=M[1],H=Object(n.useState)([]),W=Object(h.a)(H,2),B=W[0],z=W[1],J=Object(n.useState)([]),D=Object(h.a)(J,2),V=D[0],Q=D[1],Y=Object(n.useState)(""),Z=Object(h.a)(Y,2),q=(Z[0],Z[1]),K=function(){var t=Object(d.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m(a);case 2:t.sent.user||e.history.push("/login");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){K()}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("http://localhost:8000/users/getEarthMile");case 2:t=e.sent,console.log(t,"get earth mile id"),t.data.success?g(t.data.earth_mile_id):q("Error fetching earth miles");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}""===v&&function(){e.apply(this,arguments)}()}),[v]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("http://localhost:8000/earth-miles/earth-mile?id=".concat(v));case 2:t=e.sent,console.log(t,"get earthmile"),t.data.success?E(t.data.earth_mile):q("Error fetching earth miles");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}""!==v&&function(){e.apply(this,arguments)}()}),[v]),Object(n.useEffect)((function(){var e=["humans","animals","environment"];function t(){return(t=Object(d.a)(j.a.mark((function t(){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("http://localhost:8000/earth-miles/Posts?id=".concat(v,"&category=").concat(e[b]));case 2:a=t.sent,console.log(a,"get posts"),a.data.success?(0===b&&T(a.data.posts),1===b&&z(a.data.posts),2===b&&Q(a.data.posts)):q("Error fetching earth miles");case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}console.log("category ".concat(e[b])),function(){t.apply(this,arguments)}()}),[b]),Object(r.jsx)("div",{children:""===v?Object(r.jsx)("div",{children:Object(r.jsxs)("h1",{children:["You have not joined any earth mile,"," ",Object(r.jsx)("b",{children:Object(r.jsx)("a",{href:"/earthMileMap",children:"Click here"})})," ","to join now"]})}):Object(r.jsx)("div",{style:{width:"80%",margin:"auto",marginTop:"10px"},children:null!=C?Object(r.jsxs)(k.a,{position:"static",color:"default",children:[Object(r.jsx)(L.a,{children:Object(r.jsxs)(l.a,{children:[Object(r.jsxs)(A.a,{children:["Project Name: ",Object(r.jsxs)("b",{children:[C.name," "]})]})," ",Object(r.jsxs)(A.a,{children:["Users: ",Object(r.jsx)("b",{children:C.users.length})]})," ",Object(r.jsxs)(A.a,{children:["Posts:",Object(r.jsx)("b",{children:C.No_Posts})]})," ",Object(r.jsx)(o.a,{variant:"outlined",style:{color:"red"},children:"View on map"})," ",Object(r.jsx)(o.a,{variant:"outlined",color:"primary",onClick:function(){s.push({pathname:"/createPost",state:{earth_mile_id:v}})},children:"Create Post"})]})}),Object(r.jsxs)(_.a,{value:b,onChange:function(e,t){p(t)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example",children:[Object(r.jsx)(P.a,{label:"Humans"}),Object(r.jsx)(P.a,{label:"Animals"}),Object(r.jsx)(P.a,{label:"Environment"})]}),Object(r.jsxs)(U.a,{index:b,onChangeIndex:function(e){p(e)},children:[Object(r.jsx)(I,{value:0,index:0,children:0===R.length?Object(r.jsx)("h3",{children:"There are no posts, create a post!"}):R.map((function(e){return Object(r.jsx)(F,{username:e.username,image:e.image,createdAt:e.createdAt,title:e.title,description:e.description})}))}),Object(r.jsx)(I,{value:1,index:1,children:0===B.length?Object(r.jsx)("h3",{children:"There are no posts, create a post!"}):B.map((function(e){return Object(r.jsx)(F,{username:e.username,image:e.image,createdAt:e.createdAt,title:e.title,description:e.description})}))}),Object(r.jsx)(I,{value:2,index:2,children:0===V.length?Object(r.jsx)("h3",{children:"There are no posts, create a post!"}):V.map((function(e){return Object(r.jsx)(F,{username:e.username,image:e.image,createdAt:e.createdAt,title:e.title,description:e.description})}))})]})]}):Object(r.jsx)("div",{children:Object(r.jsx)("h1",{children:"Error occured, earth mile not found!"})})})})},isPrivate:!1}],xe=(a(159),function(e){var t=e.component,a=e.path,n=e.isPrivate,c=Object(M.a)(e,["component","path","isPrivate"]),s=E();return console.log(s),Object(r.jsx)(G.b,Object(v.a)({path:a,render:function(e){return n&&Boolean(""===s.user)?Object(r.jsx)(G.a,{to:{pathname:"/login"}}):Object(r.jsx)(t,Object(v.a)({},e))}},c))}),fe=a(25),ve=(a(160),a(223));function ge(){var e=Object(n.useState)(!1),t=Object(h.a)(e,2),a=t[0],c=t[1],s=E().user,i=S();return Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:a?"topnav responsive":"topnav",id:"myTopnav",children:[Object(r.jsx)(fe.b,{exact:!0,to:"/",className:"a",activeClassName:"active",children:"Home"}),Object(r.jsx)(fe.b,{exact:!0,to:"/earthMileMap",className:"a",activeClassName:"active",children:"Map"}),Object(r.jsx)(fe.b,{exact:!0,to:"/profile",className:"a",activeClassName:"active",children:"Profile"}),Object(r.jsx)(o.a,{className:"icon",onClick:function(){return c(!a)},children:Object(r.jsx)(ve.a,{className:"fa fa-bars"})}),""!==s?Object(r.jsx)(B.a,{className:"avatar",alt:"Remy Sharp",src:s.image}):"",""!==s?Object(r.jsxs)(A.a,{variant:"overline",className:"name",display:"block",gutterBottom:!0,children:["Welcome ",Object(r.jsx)("b",{children:s.username})]}):"",""!==s?Object(r.jsx)("a",{href:"javascript:void(0)",className:"a",onClick:function(){return function(e){return f.apply(this,arguments)}(i)},children:"Logout"}):"",""===s?Object(r.jsx)(fe.b,{exact:!0,to:"/login",className:"a",activeClassName:"active",children:"Login"}):""]})})}i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(N,{children:Object(r.jsxs)(fe.a,{children:[Object(r.jsx)(ge,{}),Object(r.jsx)(G.d,{children:me.map((function(e){return Object(r.jsx)(xe,{path:e.path,component:e.component,isPrivate:e.isPrivate},e.path)}))})]})})}),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.84804e96.chunk.js.map